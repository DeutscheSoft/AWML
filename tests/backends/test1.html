<head>
    <script src='../../toolkit/toolkit/G.js'></script>
    <script src='../../toolkit/toolkit/toolkit.js'></script>
    <script src='../../awml.js'></script>
    <script src='../../awml.bindings.js'></script>
    <script src='../../awml.backends.js'></script>
    <script src='../../awml.styles.js'></script>
    <awml-backend type=test name=local></awml-backend>
    <awml-backend type=test name=shared1 shared></awml-backend>
    <awml-backend type=test name=shared2 shared></awml-backend>
    <awml-backend type=websocket name=remote1 src='/test/hello'></awml-backend>
    <awml-backend type=websocket name=remote2 src='/test/hello'></awml-backend>

    <awml-backend type=websocket name=sharedremote1 src='/test/hello' shared></awml-backend>
    <awml-backend type=websocket name=sharedremote2 src='/test/hello' shared></awml-backend>
    <script>
        function random_to_color(a) {
            var r = Math.floor(a[0]*255).toString();
            var g = Math.floor(a[1]*255).toString();
            var b = Math.floor(a[2]*255).toString();
            return {
                "background-color" : "rgb(" + [r, g, b].join(",") + ")"
            };
        }
    </script>
    <style>
        div {
            display: inline-block;
            width: 100px;
            height: 100px;
            margin: 10px;
        }
    </style>
</head>
<body>
    <h1> Local Test </h1>
    <div><awml-styles transform-receive=random_to_color src='local:random.1,local:random.2,local:random.3'></awml-styles></div>

    <h1> Local Shared Worker Test </h1>
    <p> These two divs should be in sync in two different windows </p>
    <div><awml-styles transform-receive=random_to_color src='shared1:random.2,shared1:random.5,shared1:random.4'></awml-styles></div>
    <div><awml-styles transform-receive=random_to_color src='shared2:random.2,shared2:random.5,shared2:random.4'></awml-styles></div>

    <h1> Remote Test </h1>
    <p> These two divs should be in sync in two different windows across devices</p>
    <div><awml-styles transform-receive=random_to_color src='remote1:random.2,remote1:random.5,remote1:random.4'></awml-styles></div>
    <div><awml-styles transform-receive=random_to_color src='remote2:random.2,remote2:random.5,remote2:random.4'></awml-styles></div>

    <h1> Shared Remote Test </h1>
    <p> These two divs should be in sync in two different windows across devices</p>
    <div><awml-styles transform-receive=random_to_color src='sharedremote1:random.2,sharedremote1:random.5,sharedremote1:random.4'></awml-styles></div>
    <div><awml-styles transform-receive=random_to_color src='sharedremote2:random.2,sharedremote2:random.5,sharedremote2:random.4'></awml-styles></div>
</body>
