<html>
  <head>
    <script type="module">
      import { define, assertEqual } from './testing.js';
      import { getBackendValue } from '../src/index.js';

      define(async () => {
        const widget = document.querySelector('test-component').auxWidget;
        const awmlOption = document.querySelector('awml-option');

        const backendValue = getBackendValue('test:foo');

        assertEqual(widget.get('foo'), 'bar');
        backendValue.set('flu');
        assertEqual(widget.get('foo'), 'flu');
        widget.userset('foo', 'bar');
        assertEqual(await backendValue.wait(), 'bar');
        widget.set('interacting', true);
        backendValue.set('flu');
        assertEqual(widget.get('foo'), 'bar');
        widget.set('interacting', false);
        assertEqual(widget.get('foo'), 'flu');
      });
    </script>
    <script type="module" src="../src/index.js"></script>
    <script type="module" src="./test-component.js"></script>
    <awml-backend type="local" name="test">
      { "foo" : "bar" }
    </awml-backend>
  </head>
  <body>
    <test-component>
      <awml-option type="bind" name="foo" src="test:foo"></awml-option>
    </test-component>
  </body>
</html>
